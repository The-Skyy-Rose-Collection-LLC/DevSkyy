# DevSkyy Enterprise Platform - Security-Hardened Production Dependencies
# Core production dependencies only - NO dev/test tools
# Last security audit: 2025-11-29
# Version Strategy: ~= for compatible releases, >=,< for security-critical packages
# Per CLAUDE.md Truth Protocol - Enterprise-Grade Security & Performance

# ============================================================================
# BUILD DEPENDENCIES (Security-Critical)
# ============================================================================
# WHY: pip has path traversal vulnerability (CVE-2025-8869)
pip>=25.3  # SECURITY: Fix tarfile path traversal during sdist extraction
# WHY: setuptools has RCE vulnerabilities (CVE-2025-47273, CVE-2024-6345)
setuptools>=78.1.1,<79.0.0  # SECURITY: Fix path traversal → RCE, package_index RCE

# ============================================================================
# CORE FRAMEWORK
# ============================================================================
fastapi>=0.121.0,<0.122.0  # SECURITY FIX: CVE-2025-62727 (Starlette Range header DoS) + 0.121+ supports Starlette 0.49+
starlette>=0.49.1,<0.50.0  # SECURITY FIX: GHSA-7f5h-v6xp-fcq8 (Range header ReDoS)
flask~=3.1.2  # Flask web framework
uvicorn[standard]~=0.38.0  # ASGI server with websockets
pydantic[email]>=2.9.0,<3.0.0  # SECURITY: Schema validation, supports langchain 0.3+
python-dotenv>=1.1.0,<2.0.0  # Environment variable management (compatible with fastmcp>=2.13.0)
email-validator~=2.1.0  # Required for Pydantic email validation
blinker~=1.9.0  # Flask signaling support
werkzeug>=3.1.3,<4.0.0  # SECURITY: WSGI utility library for Flask
itsdangerous>=2.2.0,<3.0.0  # SECURITY: Secure data signing for Flask

# ============================================================================
# AGENT FRAMEWORK & MCP
# ============================================================================
claude-agent-sdk~=0.1.9  # Official Anthropic Agent SDK with MCP 1.22.0
mcp~=1.22.0  # Model Context Protocol - official implementation
fastmcp>=2.13.0,<3.0.0  # SECURITY FIX: GHSA-mxxr-jv3v-6pgc (XSS), GHSA-rj5c-58rq-j5g5 (Command Injection)

# ============================================================================
# AGENT OBSERVABILITY & TRAINING
# ============================================================================
logfire[fastapi]~=4.14.2  # OpenTelemetry-based observability for FastAPI

# ============================================================================
# DATABASE (Enterprise-Grade)
# ============================================================================
SQLAlchemy~=2.0.36  # ORM - works with SQLite, PostgreSQL, MySQL
aiosqlite~=0.20.0  # Async SQLite driver
asyncpg~=0.30.0  # Async PostgreSQL driver
psycopg2-binary~=2.9.9  # PostgreSQL driver for Neon integration
neon-api~=0.3.0  # Neon serverless Postgres API client

# ============================================================================
# HTTP & API
# ============================================================================
requests>=2.32.4,<3.0.0  # SECURITY: Fix GHSA-9hjg-9r4m-mvj7
python-multipart~=0.0.18  # File upload support
aiofiles~=24.1.0  # Async file operations
httpx~=0.28.1  # Modern async HTTP client

# ============================================================================
# AUTHENTICATION & SECURITY (Enterprise)
# ============================================================================
passlib[bcrypt]>=1.7.4,<2.0.0  # SECURITY: Password hashing
paramiko>=3.5.0,<4.0.0  # SECURITY: SSH protocol
certifi>=2024.12.14,<2025.0.0  # SECURITY: SSL certificates
cryptography>=46.0.3,<47.0.0  # SECURITY: Fix CVE-2024-26130, CVE-2023-50782, CVE-2024-0727, OpenSSL vulns
PyJWT~=2.10.1  # JWT authentication per RFC 7519
bcrypt>=4.2.1,<5.0.0  # SECURITY: bcrypt password hashing
argon2-cffi>=23.1.0,<24.0.0  # SECURITY: Argon2 password hashing
defusedxml>=0.7.1,<1.0.0  # SECURITY: P0 CRITICAL - Protect against XML attacks (XXE, billion laughs)

# ============================================================================
# SECURITY MIDDLEWARE
# ============================================================================
slowapi~=0.1.9  # Rate limiting middleware
secure~=0.3.0  # Security headers middleware

# ============================================================================
# AI & ML (Latest Stable)
anthropic~=0.69.0  # Latest version
openai~=2.7.2  # Latest version - Updated 2025-11-10
huggingface_hub~=0.36.0  # Hugging Face model hub client - Updated 2025-11-10
transformers~=4.57.1  # Latest version - Updated 2025-11-10
tokenizers>=0.22.0,<0.24.0  # Required by transformers - Relaxed for chromadb compatibility
torch>=2.8.0,<2.9.0  # SECURITY FIX CVE-2025-3730 (DoS vulnerability) - NumPy 2.x compatible
torchvision>=0.23.0,<0.24.0  # Compatible with torch 2.8+ per official matrix - NumPy 2.x compatible
torchaudio>=2.8.0,<2.9.0  # Compatible with torch 2.8+ - NumPy 2.x compatible
# SECURITY: Using torch 2.8.0+ to fix DoS vulnerability in 2.7.1
diffusers~=0.35.2  # Latest version - Updated 2025-11-10 - NumPy 2.x compatible
safetensors~=0.6.2  # Safe tensor serialization - Updated 2025-11-10
sentence-transformers~=3.4.1  # Updated: 4.48.0 doesn't exist, using stable 3.4.1
scikit-learn~=1.5.2  # NumPy 2.x compatible (supports >=1.19.5)
# ============================================================================
# NUMPY 2.2.6 COMPATIBILITY MATRIX (Verified 2025-11-16)
# ============================================================================
# All packages verified for NumPy 2.2.6 compatibility:
# ✅ torch 2.7.1 - Supports NumPy 2.x (released with 2.x support)
# ✅ scipy 1.16.3 - Requires >=1.25.2, supports NumPy 2.x
# ✅ scikit-learn 1.5.2 - Supports NumPy 2.x
# ✅ pandas 2.3.3 - Supports NumPy 2.x (requires >=1.23.2)
# ✅ opencv-python 4.11.0.86 - Supports NumPy 2.x
# ✅ chromadb 1.3.4 - Supports NumPy 2.x (requires >=1.22.5)
# ✅ shap 0.50.0 - NumPy 2.0-2.2 (numba constraint <=2.2)
# ✅ stable-baselines3 2.7.0 - Supports NumPy 2.x
# ✅ transformers 4.57.1 - Supports NumPy 2.x
#
# CONSTRAINT: numpy~=2.2.6 (NOT 2.3+) due to numba dependency in SHAP
# Numba (SHAP's dependency) requires numpy<=2.2 as of November 2025
# ============================================================================
numpy~=2.2.6  # NumPy 2.2.6 - Max version for SHAP/numba compatibility, min for all other packages
pandas~=2.3.3  # Updated for security fixes
# tensorflow==2.16.2  # Disabled due to system compatibility issues - will re-enable in Phase 3
xgboost~=2.1.3
lightgbm~=4.6.0  # Updated to fix PYSEC-2024-231 vulnerability

# Computer Vision & Image Processing
opencv-python~=4.11.0.86  # Updated
pillow~=12.0.0  # Latest version - Updated 2025-11-10
imagehash~=4.3.2

# Video Processing & Generation
moviepy~=1.0.3  # Video editing and processing
imageio~=2.36.1  # Image I/O for video frames
imageio-ffmpeg~=0.5.1  # FFmpeg wrapper for video encoding
peft~=0.14.0  # Parameter-Efficient Fine-Tuning for LoRA

# ============================================================================
# WEB SCRAPING & PARSING
# ============================================================================
beautifulsoup4~=4.12.3  # HTML/XML parsing
lxml~=5.3.0  # SECURITY: XML/HTML parser

# ============================================================================
# WEB AUTOMATION
# ============================================================================
selenium~=4.27.1  # Browser automation
playwright~=1.49.1  # Modern web automation
webdriver-manager~=4.0.2  # WebDriver management

# ============================================================================
# PERFORMANCE & MONITORING
# ============================================================================
psutil~=6.0.0  # System utilization
prometheus-client~=0.22.0  # Metrics collection
sentry-sdk~=2.19.0  # Error tracking
elastic-apm~=6.24.0  # Application Performance Monitoring

# ============================================================================
# ADVANCED MONITORING
# ============================================================================
grafana-api~=1.0.3  # Grafana integration
structlog~=24.4.0  # Structured logging
py-cpuinfo~=9.0.0  # System information

# ============================================================================
# ADDITIONAL ENTERPRISE TOOLS
# ============================================================================
click~=8.1.8  # CLI framework
python-slugify~=8.0.4  # URL-safe slugs
redis~=5.2.1  # Redis client
celery[redis]~=5.4.0  # Distributed task queue
alembic~=1.14.0  # Database migrations

# Async Support
aioredis~=2.0.1
aiomysql~=0.3.0  # MySQL async - Updated to fix GHSA-r397-ff8c-wv2g vulnerability

# Social Media & Marketing APIs (Verified)
facebook-sdk~=3.1.0
# instagrapi==2.1.2  # Disabled: requires pydantic==2.7.1 exactly, conflicts with current pydantic 2.10.4
tweepy~=4.14.0
google-api-python-client~=2.155.0  # Updated
linkedin-api~=2.3.0

# Voice & Audio Processing
elevenlabs~=1.12.0  # Updated
openai-whisper==20240930  # Stable September 2024 release (compatible with torch 2.7.x)
pydub~=0.25.1
speechrecognition~=3.12.0  # Updated
# pyaudio==0.2.14  # Audio I/O - Disabled: requires PortAudio system libraries not available in Docker

# NLP & Sentiment Analysis
textblob~=0.18.0.post0
vaderSentiment~=3.3.2
spacy~=3.8.3
nltk~=3.9.1
langchain~=1.0.7  # LLM orchestration - Updated to stable 1.0 release
langchain-text-splitters>=0.3.9,<1.0.0  # SECURITY FIX: GHSA-m42m-m8cr-8m58 (XXE vulnerability)
langsmith~=0.4.43  # LLM monitoring - Updated to latest stable

# ============================================================================
# RAG (Retrieval-Augmented Generation)
chromadb~=1.3.4  # Vector database for semantic search - Updated to fix tokenizers conflict
tiktoken~=0.8.0  # Token counting for embeddings
pypdf>=6.1.3,<7.0.0  # SECURITY: PDF processing - Fix 3 CVEs (RAM exhaustion, infinite loop, memory exhaustion)
python-docx~=1.1.2  # Word document processing
python-magic~=0.4.27  # File type detection
faiss-cpu~=1.9.0.post1  # Facebook AI Similarity Search (CPU version)

# Blockchain & Web3 (Security Verified)
web3~=7.7.0  # Updated
eth-account~=0.13.4
eth-typing~=5.0.1
eth-utils~=5.1.0

# Data Science & Visualization
joblib~=1.5.2  # Updated: 1.4.3 doesn't exist, using latest stable
scipy~=1.16.3  # Updated to support numpy 2.3.x
statsmodels~=0.14.4
seaborn~=0.13.2
matplotlib~=3.9.3
plotly~=5.24.1  # Interactive plots

# Machine Learning Extensions
gym~=0.26.2
stable-baselines3~=2.7.0  # Updated to support numpy 2.x
optuna~=4.1.0  # Hyperparameter optimization
mlflow>=3.2.0,<4.0.0  # ML lifecycle - SECURITY: Updated to fix GHSA-wf7f-8fxf-xfxc and additional CVE
shap~=0.50.0  # Model explainability - Updated for numpy 2.x compatibility
keras>=3.11.0,<4.0.0  # SECURITY FIX: Multiple RCE vulnerabilities (GHSA-cjgq-5qmw-rcj6, GHSA-36fq-jgmw-4r9c, GHSA-mq84-hjqx-cwf2, GHSA-28jp-44vh-q42h)

# Code Analysis
astroid~=3.3.8  # Updated
rope~=1.13.0  # Refactoring
jedi~=0.19.2  # Code completion

# CMS Integration
# python-wordpress-xmlrpc==2.3  # DISABLED: setuptools compatibility issue - use direct HTTP/REST API instead
woocommerce~=3.0.0

# Logging & Observability
python-json-logger~=3.2.0
loguru~=0.7.3  # Enhanced logging

# ============================================================================
# DATA VALIDATION
# ============================================================================
cerberus~=1.3.6  # Schema validation
marshmallow~=3.23.2  # Object serialization/deserialization

# ============================================================================
# CACHING
# ============================================================================
cachetools~=5.5.0  # In-memory caching
diskcache~=5.6.3  # Disk-based cache
pymemcache~=4.0.0  # Memcached client

# ============================================================================
# QUEUE & MESSAGING
# ============================================================================
kombu~=5.4.2  # Messaging library for Celery
pika~=1.3.2  # RabbitMQ client
kafka-python~=2.0.2  # Apache Kafka client

# ============================================================================
# COMPRESSION & ENCODING
# ============================================================================
brotli>=1.2.0,<2.0.0  # SECURITY FIX: GHSA-2qfp-q593-8484 (DoS via decompression bomb)
python-snappy~=0.7.3  # Snappy compression
lz4~=4.3.3  # LZ4 compression
zstandard~=0.23.0  # Zstandard compression

# ============================================================================
# DATE & TIME
# ============================================================================
python-dateutil~=2.9.0.post0  # Date utilities
pytz~=2024.2  # Timezone definitions
pendulum~=3.0.0  # Python datetimes made easy

# ============================================================================
# ENVIRONMENT & CONFIG
# ============================================================================
python-decouple~=3.8  # Separate settings from code
environs~=11.2.1  # Environment variable parsing
dynaconf~=3.2.8  # Dynamic configuration management

# ============================================================================
# API DOCUMENTATION
# ============================================================================
apispec~=6.7.1  # API specification generator
pydantic-openapi-schema~=1.5.1  # Pydantic OpenAPI schema

# ============================================================================
# SECURITY COMPLIANCE
# ============================================================================
pycryptodome~=3.21.0  # Cryptographic library
pyotp~=2.9.0  # 2FA/MFA support

# ============================================================================
# ENTERPRISE MONITORING
# ============================================================================
datadog~=0.50.2  # Datadog monitoring
newrelic~=10.4.0  # New Relic APM
boto3~=1.36.7  # AWS SDK

# ============================================================================
# VERSION CONTROL
# ============================================================================
gitpython~=3.1.43  # Git integration
pygit2~=1.16.0  # Python bindings to libgit2

# ============================================================================
# DOCUMENTATION
# ============================================================================
sphinx~=8.1.3  # Documentation generator
mkdocs~=1.6.1  # Project documentation with Markdown
mkdocs-material~=9.5.47  # Material Design theme for MkDocs

# ============================================================================
# VECTOR DATABASES (PRODUCTION-GRADE)
# ============================================================================
pinecone-client~=5.0.1  # Managed vector database for production RAG

# ============================================================================
# TIER 1 SDKs (High Priority) - Added 2025-11-20
# ============================================================================
stripe~=11.1.1  # Payment processing and subscriptions
# sendgrid~=6.11.0  # Email delivery - DISABLED: starkbank-ecdsa build issue, use SMTP or alternatives
litellm>=1.61.15,<2.0.0  # SECURITY: Fix GHSA-fh2c-86xm-pm2x, GHSA-fjcf-3j3r-78rp, GHSA-gw2q-qw9j-rgv7 (3 HIGH severity CVEs)
PyGithub~=2.5.0  # GitHub API automation
posthog~=3.8.2  # Product analytics and feature flags
